# 光復 e 互助平台 - 使用者流程文件

**文件版本**: v1.0
**建立日期**: 2025-10-03_00:36:04
**最後更新**: 2025-10-03_00:36:04

---

## 📋 目錄

1. [核心使用者流程](#核心使用者流程)
2. [受災戶流程](#受災戶流程)
3. [志工流程](#志工流程)
4. [管理員流程](#管理員流程)
5. [組織流程](#組織流程)
6. [頁面結構](#頁面結構)

---

## 核心使用者流程

### 1. 新使用者註冊流程

```
開始
  ↓
訪問平台首頁
  ↓
點擊「註冊」按鈕
  ↓
填寫註冊表單
  - Email
  - 密碼
  - 姓名
  - 電話 (選填)
  - 選擇角色
  ↓
[判斷] 是否為組織角色？
  │
  ├─ 是 → 填寫組織資訊
  │        - 組織名稱
  │        - 組織類型
  │        - 聯絡人
  │        - 地址
  │        - 描述
  │        ↓
  │      提交申請
  │        ↓
  │      等待審核
  │        ↓
  │      審核通過 → 啟用帳號
  │
  └─ 否 → 直接建立帳號
           ↓
         自動登入
           ↓
         進入儀表板
           ↓
         結束
```

### 2. 使用者登入流程

```
開始
  ↓
訪問登入頁面 (/login)
  ↓
輸入 Email & 密碼
  ↓
點擊「登入」
  ↓
[判斷] 驗證結果？
  │
  ├─ 成功 → 取得 JWT Token
  │          ↓
  │        儲存 Token 至 Session
  │          ↓
  │        導向儀表板 (/dashboard)
  │          ↓
  │        結束
  │
  └─ 失敗 → 顯示錯誤訊息
             ↓
           重新輸入
```

---

## 受災戶流程

### 流程 A: 提出需求任務

```
受災戶登入
  ↓
進入儀表板 (/dashboard)
  ↓
點擊「建立新任務」按鈕
  ↓
填寫任務表單
  ┌─────────────────────┐
  │ - 任務標題          │
  │ - 任務描述          │
  │ - 任務類型 (下拉選單)│
  │ - 地點資訊          │
  │   * 地址            │
  │   * 座標 (地圖選點) │
  │   * 詳細說明        │
  │ - 需要志工人數      │
  │ - 所需技能 (選填)   │
  │ - 截止時間 (選填)   │
  │ - 優先級 (1-5)      │
  └─────────────────────┘
  ↓
點擊「提交任務」
  ↓
[系統] 建立任務
  - 狀態設為 pending
  - 記錄建立者資訊
  ↓
顯示「任務已提交，等待審核」
  ↓
[管理員] 審核任務
  ↓
審核通過
  ↓
[系統] 任務狀態變更為 available
  ↓
[通知] 受災戶收到審核通過通知
  ↓
任務出現在可認領列表
  ↓
等待志工認領
```

### 流程 B: 追蹤任務進度

```
受災戶登入
  ↓
進入「我的任務」頁面
  ↓
查看任務列表
  - 顯示任務狀態
  - 顯示已認領志工數/需求人數
  - 顯示任務進度
  ↓
點擊任務查看詳情
  ↓
查看任務資訊
  - 認領志工名單
  - 任務狀態歷史
  - 進度更新記錄
  ↓
[可選] 與志工溝通
  ↓
[任務完成] 確認任務完成
  ↓
給予回饋與評價 (未來功能)
```

---

## 志工流程

### 流程 A: 瀏覽並認領任務

```
志工登入
  ↓
進入任務列表 (/dashboard)
  ↓
瀏覽可認領任務
  ↓
[可選] 使用篩選功能
  - 任務類型篩選
  - 地點篩選
  - 優先級排序
  - 關鍵字搜尋
  ↓
找到感興趣的任務
  ↓
點擊查看任務詳情
  ↓
閱讀任務資訊
  - 任務描述
  - 所需人數與已認領人數
  - 地點與地圖
  - 所需技能
  - 截止時間
  ↓
[判斷] 是否符合需求？
  │
  ├─ 是 → 點擊「認領任務」
  │        ↓
  │      [系統] 檢查認領資格
  │        - 是否已滿額
  │        - 使用者是否已認領
  │        ↓
  │      [判斷] 檢查結果？
  │        │
  │        ├─ 通過 → 認領成功
  │        │          ↓
  │        │        任務狀態變更為 claimed
  │        │          ↓
  │        │        顯示「認領成功」訊息
  │        │          ↓
  │        │        導向「我的任務」
  │        │
  │        └─ 失敗 → 顯示錯誤訊息
  │                   ↓
  │                 返回任務列表
  │
  └─ 否 → 返回任務列表
           ↓
         繼續瀏覽其他任務
```

### 流程 B: 執行任務

```
志工檢視已認領任務
  ↓
進入「我的任務」頁面
  ↓
選擇要執行的任務
  ↓
查看任務詳情
  - 任務地點與導航
  - 聯絡資訊
  - 其他志工名單
  ↓
[可選] 聯繫需求者或其他志工
  ↓
前往任務地點
  ↓
開始執行任務
  ↓
[系統] 更新任務狀態為 in_progress
  ↓
執行任務中
  ↓
[可選] 更新任務進度
  - 拍照記錄
  - 文字說明
  ↓
任務完成
  ↓
點擊「標記為完成」
  ↓
[系統] 任務狀態變更為 completed
  ↓
[通知] 通知需求者任務已完成
  ↓
結束
```

---

## 管理員流程

### 流程 A: 審核任務

```
管理員登入
  ↓
進入「待審核任務」頁面 (/dashboard/pending-tasks)
  ↓
查看待審核任務列表
  - 按提交時間排序
  - 顯示任務基本資訊
  - 顯示提交者資訊
  ↓
選擇要審核的任務
  ↓
查看任務詳細內容
  - 任務描述
  - 地點資訊
  - 需求人數
  - 優先級
  - 建立者資訊
  ↓
[判斷] 審核決定？
  │
  ├─ 通過 → 點擊「通過審核」
  │          ↓
  │        [系統] 更新任務狀態為 available
  │          ↓
  │        [系統] 記錄審核者與審核時間
  │          ↓
  │        [通知] 通知建立者審核通過
  │          ↓
  │        任務出現在可認領列表
  │
  └─ 拒絕 → 填寫拒絕原因
             ↓
           點擊「拒絕審核」
             ↓
           [系統] 任務狀態變更為 cancelled
             ↓
           [通知] 通知建立者並附上拒絕原因
             ↓
           建立者可修改後重新提交
```

### 流程 B: 審核組織申請

```
管理員登入
  ↓
進入「組織審核」頁面
  ↓
查看待審核組織列表
  ↓
選擇要審核的組織
  ↓
查看組織申請資訊
  - 組織名稱
  - 組織類型
  - 聯絡人與電話
  - 地址
  - 組織描述
  - 申請人資訊
  ↓
[可選] 進行背景調查
  ↓
[判斷] 審核決定？
  │
  ├─ 通過 → 點擊「核准組織」
  │          ↓
  │        [系統] 更新組織狀態為 approved
  │          ↓
  │        [系統] 啟用申請人帳號
  │          ↓
  │        [通知] 通知申請人審核通過
  │
  └─ 拒絕 → 填寫拒絕原因
             ↓
           點擊「拒絕申請」
             ↓
           [系統] 記錄拒絕原因
             ↓
           [通知] 通知申請人並附上原因
             ↓
           申請人可修改後重新提交
```

---

## 組織流程

### 流程 A: 組織申請

```
使用者註冊時選擇組織角色
  ↓
填寫組織資訊表單
  ┌──────────────────┐
  │ - 組織名稱       │
  │ - 組織類型       │
  │   * 官方組織     │
  │   * 非官方組織   │
  │ - 聯絡人姓名     │
  │ - 聯絡電話       │
  │ - 組織地址       │
  │ - 組織描述       │
  │ - 證明文件 (選填)│
  └──────────────────┘
  ↓
提交申請
  ↓
[系統] 建立組織申請記錄
  - 狀態設為 pending
  ↓
顯示「申請已提交」訊息
  ↓
等待管理員審核
  ↓
[通知] 收到審核結果通知
  ↓
[判斷] 審核結果？
  │
  ├─ 通過 → 帳號啟用
  │          ↓
  │        可正常登入使用平台
  │
  └─ 拒絕 → 查看拒絕原因
             ↓
           修改申請內容
             ↓
           重新提交申請
```

### 流程 B: 組織建立任務

```
組織登入
  ↓
進入儀表板
  ↓
點擊「建立新任務」
  ↓
填寫任務資訊
  (同受災戶流程)
  ↓
提交任務
  ↓
[判斷] 組織類型？
  │
  ├─ 官方組織 → 任務直接變為 available
  │              (免審核)
  │
  └─ 非官方組織 → 任務進入 pending 狀態
                   ↓
                 等待管理員審核
```

---

## 頁面結構

### 頁面架構圖

```
/ (首頁)
│
├── /login (登入頁)
│
├── /register (註冊頁)
│
└── /dashboard (儀表板) - 需登入
    │
    ├── / (任務列表主頁)
    │   ├── 篩選器 (任務類型、地點、狀態)
    │   ├── 搜尋框
    │   └── 任務卡片列表
    │
    ├── /task/[taskId] (任務詳情頁)
    │   ├── 任務資訊
    │   ├── 地圖顯示
    │   ├── 認領按鈕
    │   └── 狀態更新
    │
    ├── /my-tasks (我的任務)
    │   ├── 我建立的任務
    │   └── 我認領的任務
    │
    ├── /create-task (建立任務) - 限特定角色
    │   └── 任務建立表單
    │
    ├── /pending-tasks (待審核任務) - 限管理員
    │   └── 待審核任務列表
    │
    ├── /organizations (組織管理) - 限管理員
    │   ├── 待審核組織
    │   └── 已核准組織
    │
    └── /profile (個人資料)
        ├── 基本資料編輯
        └── 密碼變更
```

### 頁面導航流程

```
                    [登入]
                      ↓
              ┌─── Dashboard ───┐
              │                 │
              ↓                 ↓
         任務列表          我的任務
              ↓                 ↓
         任務詳情          任務詳情
              ↓
         認領/編輯


    [管理員額外頁面]
              ↓
     ┌────────┴────────┐
     ↓                 ↓
待審核任務        組織管理
     ↓                 ↓
  任務審核          組織審核
```

---

## 關鍵頁面線框圖說明

### 1. 任務列表頁 (/dashboard)

**版面配置**:
```
┌────────────────────────────────────────────┐
│  [Logo]  光復e互助平台      [使用者選單]   │
├────────────────────────────────────────────┤
│                                            │
│  篩選器:                                   │
│  [任務類型 ▼] [地點 ▼] [狀態 ▼] [搜尋...]│
│                                            │
│  ┌──────────────────────────────────────┐ │
│  │ 🔴 優先級5 | 緊急救援                 │ │
│  │ 清理倒塌房屋瓦礫                      │ │
│  │ 📍 光復鄉大全街 | 需要 5 人 | 3/5 已認領│ │
│  │ [查看詳情]                           │ │
│  └──────────────────────────────────────┘ │
│                                            │
│  ┌──────────────────────────────────────┐ │
│  │ 🟠 優先級3 | 物資配送                 │ │
│  │ 配送飲用水與食物                      │ │
│  │ 📍 光復鄉中正路 | 需要 3 人 | 0/3 已認領│ │
│  │ [查看詳情]                           │ │
│  └──────────────────────────────────────┘ │
│                                            │
│  [載入更多...]                             │
└────────────────────────────────────────────┘
```

### 2. 任務詳情頁 (/dashboard/[taskId])

**版面配置**:
```
┌────────────────────────────────────────────┐
│  ← 返回          任務詳情                   │
├────────────────────────────────────────────┤
│                                            │
│  清理倒塌房屋瓦礫                          │
│  🔴 優先級 5/5 | 緊急救援                  │
│                                            │
│  ─────────────────────────────────────     │
│                                            │
│  📋 任務描述                               │
│  房屋因地震倒塌，需要志工協助清理瓦礫...   │
│                                            │
│  📍 地點資訊                               │
│  花蓮縣光復鄉大全街123號                   │
│  [地圖顯示]                                │
│                                            │
│  👥 志工需求                               │
│  需要人數: 5 人                            │
│  已認領: 3 人 (60%)                        │
│  所需技能: 體力勞動、基礎工具使用          │
│                                            │
│  ⏰ 截止時間                               │
│  2025-10-05 17:00                          │
│                                            │
│  👤 建立者                                 │
│  張志明 (受災戶)                           │
│                                            │
│  ─────────────────────────────────────     │
│                                            │
│  [認領此任務]                              │
│                                            │
└────────────────────────────────────────────┘
```

---

**文件結束**
